{"ast":null,"code":"import axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { history } from '../..';\n\nconst sleep = () => new Promise(resolve => setTimeout(resolve, 400));\n\naxios.defaults.baseURL = 'http://localhost:5000/api/';\naxios.defaults.withCredentials = true;\n\nconst responseBody = response => response.data;\n\naxios.interceptors.response.use(async response => {\n  await sleep();\n  return response;\n}, error => {\n  const {\n    data,\n    status\n  } = error.response;\n\n  switch (status) {\n    case 400:\n      if (data.errors) {\n        const modelStateErrors = [];\n\n        for (const key in data.errors) {\n          if (data.errors[key]) {\n            modelStateErrors.push(data.errors[key]);\n          }\n        }\n\n        throw modelStateErrors.flat();\n      }\n\n      toast.error(data.title);\n      break;\n\n    case 401:\n      toast.error(data.title);\n      break;\n\n    case 500:\n      history.push({\n        pathname: '/server-error'\n      });\n      break;\n\n    default:\n      break;\n  }\n\n  return Promise.reject(error.response);\n});\nconst requests = {\n  get: url => axios.get(url).then(responseBody),\n  post: (url, body) => axios.post(url, body).then(responseBody),\n  put: (url, body) => axios.put(url, body).then(responseBody),\n  delete: url => axios.delete(url).then(responseBody)\n};\nconst Catalog = {\n  list: () => requests.get('products'),\n  details: id => requests.get(`products/${id}`),\n  filter: () => requests.get('filter')\n};\nconst TestErrors = {\n  get400Error: () => requests.get('error/bad-request'),\n  get401Error: () => requests.get('error/unauthorized'),\n  get404Error: () => requests.get('error/not-found'),\n  get500Error: () => requests.get('error/server-error'),\n  getValidationError: () => requests.get('error/validation-error')\n};\nconst Basket = {\n  get: () => requests.get('basket'),\n  addItem: function (productId) {\n    let quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return requests.post(`basket?productId=${productId}&quantity=${quantity}`, {});\n  },\n  removeItem: function (productId) {\n    let quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return requests.delete(`basket?productId=${productId}&quantity=${quantity}`);\n  }\n};\nconst Agent = {\n  Catalog,\n  TestErrors,\n  Basket\n};\nexport default Agent;","map":{"version":3,"names":["axios","toast","history","sleep","Promise","resolve","setTimeout","defaults","baseURL","withCredentials","responseBody","response","data","interceptors","use","error","status","errors","modelStateErrors","key","push","flat","title","pathname","reject","requests","get","url","then","post","body","put","delete","Catalog","list","details","id","filter","TestErrors","get400Error","get401Error","get404Error","get500Error","getValidationError","Basket","addItem","productId","quantity","removeItem","Agent"],"sources":["D:/Project/client/src/App/Api/Agent.ts"],"sourcesContent":["import axios, { AxiosError, AxiosResponse } from 'axios';\r\nimport { request } from 'http';\r\nimport { toast } from 'react-toastify';\r\nimport { history } from '../..';\r\n\r\n\r\nconst sleep = () => new Promise(resolve => setTimeout(resolve, 400));\r\n\r\naxios.defaults.baseURL = 'http://localhost:5000/api/';\r\naxios.defaults.withCredentials = true;\r\n\r\nconst responseBody = (response: AxiosResponse) => response.data;\r\n\r\naxios.interceptors.response.use(async response => {\r\n    await sleep();\r\n    return response\r\n}, (error: AxiosError) => {\r\n    const { data, status } = error.response!;\r\n\r\n    switch (status) {\r\n        case 400:\r\n            if (data.errors) {\r\n                const modelStateErrors: string[] = [];\r\n                for (const key in data.errors) {\r\n                    if (data.errors[key]) {\r\n                        modelStateErrors.push(data.errors[key])\r\n                    }\r\n                }\r\n                throw modelStateErrors.flat();\r\n            }\r\n            toast.error(data.title);\r\n            break;\r\n        case 401:\r\n            toast.error(data.title);\r\n            break;\r\n        case 500:\r\n            history.push({\r\n                pathname: '/server-error'\r\n            });\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    return Promise.reject(error.response);\r\n});\r\n\r\nconst requests = {\r\n    get: (url: string) => axios.get(url).then(responseBody),\r\n    post: (url: string, body: {}) => axios.post(url, body).then(responseBody),\r\n    put: (url: string, body: {}) => axios.put(url, body).then(responseBody),\r\n    delete: (url: string) => axios.delete(url).then(responseBody),\r\n}\r\n\r\nconst Catalog = {\r\n    list: () => requests.get('products'),\r\n    details: (id: number) => requests.get(`products/${id}`),\r\n    filter:() => requests.get('filter')\r\n}\r\n\r\nconst TestErrors = {\r\n    get400Error: () => requests.get('error/bad-request'),\r\n    get401Error: () => requests.get('error/unauthorized'),\r\n    get404Error: () => requests.get('error/not-found'),\r\n    get500Error: () => requests.get('error/server-error'),\r\n    getValidationError: () => requests.get('error/validation-error'),\r\n}\r\n\r\nconst Basket = {\r\n    get: () => requests.get('basket'),\r\n    addItem: (productId: number, quantity = 1) => requests.post(`basket?productId=${productId}&quantity=${quantity}`, {}),\r\n    removeItem: (productId: number, quantity = 1) => requests.delete(`basket?productId=${productId}&quantity=${quantity}`),\r\n\r\n}\r\n\r\nconst Agent = {\r\n    Catalog,\r\n    TestErrors,\r\n    Basket\r\n}\r\n\r\nexport default Agent;"],"mappings":"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"},"metadata":{},"sourceType":"module"}