{"ast":null,"code":"import axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { history } from '../..';\naxios.defaults.baseURL = 'http://localhost:5000/api/';\n\nconst responseBody = response => response.data;\n\nconst navigate = useNavigate();\naxios.interceptors.response.use(response => {\n  return response;\n}, error => {\n  const {\n    data,\n    status\n  } = error.response;\n\n  switch (status) {\n    case 400:\n      if (data.errors) {\n        const modelStateErrors = [];\n\n        for (const key in data.errors) {\n          if (data.errors[key]) {\n            modelStateErrors.push(data.errors[key]);\n          }\n        }\n\n        throw modelStateErrors.flat();\n      }\n\n      toast.error(data.title);\n      break;\n\n    case 401:\n      toast.error(data.title);\n      break;\n\n    case 500:\n      history.push({\n        pathname: '/server-error',\n        state: {\n          error: error\n        }\n      });\n      break;\n\n    default:\n      break;\n  }\n\n  return Promise.reject(error.response);\n});\nconst requests = {\n  get: url => axios.get(url).then(responseBody),\n  post: (url, body) => axios.post(url, body).then(responseBody),\n  put: (url, body) => axios.put(url, body).then(responseBody),\n  delete: url => axios.delete(url).then(responseBody)\n};\nconst Catalog = {\n  list: () => requests.get('products'),\n  details: id => requests.get(`products/${id}`)\n};\nconst TestErrors = {\n  get400Error: () => requests.get('buggy/bad-request'),\n  get401Error: () => requests.get('buggy/unauthorized'),\n  get404Error: () => requests.get('buggy/not-found'),\n  get500Error: () => requests.get('buggy/server-error'),\n  getValidationError: () => requests.get('buggy/validation-error')\n};\nconst Agent = {\n  Catalog,\n  TestErrors\n};\nexport default Agent;","map":{"version":3,"names":["axios","toast","history","defaults","baseURL","responseBody","response","data","navigate","useNavigate","interceptors","use","error","status","errors","modelStateErrors","key","push","flat","title","pathname","state","Promise","reject","requests","get","url","then","post","body","put","delete","Catalog","list","details","id","TestErrors","get400Error","get401Error","get404Error","get500Error","getValidationError","Agent"],"sources":["D:/Project/client/src/App/Api/Agent.ts"],"sourcesContent":["import  axios, { AxiosError, AxiosResponse }  from 'axios';\r\nimport { toast } from 'react-toastify';\r\nimport { history } from '../..';\r\n\r\naxios.defaults.baseURL  = 'http://localhost:5000/api/';\r\n\r\nconst responseBody = (response: AxiosResponse) => response.data;\r\n\r\nconst navigate = useNavigate();\r\n\r\naxios.interceptors.response.use(response => {\r\n    return response\r\n}, (error:AxiosError) => {\r\n    const {data, status} = error.response!;\r\n\r\n    switch(status){\r\n        case 400:\r\n            if(data.errors){\r\n                const modelStateErrors:string[] =[];\r\n                for(const key in data.errors){\r\n                    if(data.errors[key]){\r\n                        modelStateErrors.push(data.errors[key])\r\n                    }   \r\n                }\r\n                throw modelStateErrors.flat();\r\n            }\r\n        \r\n            toast.error(data.title);\r\n            break;\r\n        case 401:\r\n            toast.error(data.title);\r\n            break;\r\n        case 500:\r\n            history.push({\r\n                pathname:'/server-error',\r\n                state: {error:error}\r\n            });\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    return Promise.reject(error.response);\r\n});\r\n\r\nconst requests = {\r\n    get: (url:string) => axios.get(url).then(responseBody),\r\n    post: (url:string, body:{}) => axios.post(url, body).then(responseBody),\r\n    put: (url:string, body:{}) => axios.put(url, body).then(responseBody),\r\n   delete: (url:string) => axios.delete(url).then(responseBody),\r\n}\r\n\r\nconst Catalog = {\r\n    list: () => requests.get('products'),\r\n    details: (id: number) => requests.get(`products/${id}`)\r\n}\r\n\r\nconst TestErrors = {\r\n    get400Error:() => requests.get('buggy/bad-request'),\r\n    get401Error:() => requests.get('buggy/unauthorized'),\r\n    get404Error:() => requests.get('buggy/not-found'),\r\n    get500Error:() => requests.get('buggy/server-error'),\r\n    getValidationError:() => requests.get('buggy/validation-error'),\r\n}\r\n\r\nconst Agent = {\r\n    Catalog,\r\n    TestErrors\r\n}\r\n\r\nexport default Agent;"],"mappings":"AAAA,OAAQA,KAAR,MAAmD,OAAnD;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,OAAT,QAAwB,OAAxB;AAEAF,KAAK,CAACG,QAAN,CAAeC,OAAf,GAA0B,4BAA1B;;AAEA,MAAMC,YAAY,GAAIC,QAAD,IAA6BA,QAAQ,CAACC,IAA3D;;AAEA,MAAMC,QAAQ,GAAGC,WAAW,EAA5B;AAEAT,KAAK,CAACU,YAAN,CAAmBJ,QAAnB,CAA4BK,GAA5B,CAAgCL,QAAQ,IAAI;EACxC,OAAOA,QAAP;AACH,CAFD,EAEIM,KAAD,IAAsB;EACrB,MAAM;IAACL,IAAD;IAAOM;EAAP,IAAiBD,KAAK,CAACN,QAA7B;;EAEA,QAAOO,MAAP;IACI,KAAK,GAAL;MACI,IAAGN,IAAI,CAACO,MAAR,EAAe;QACX,MAAMC,gBAAyB,GAAE,EAAjC;;QACA,KAAI,MAAMC,GAAV,IAAiBT,IAAI,CAACO,MAAtB,EAA6B;UACzB,IAAGP,IAAI,CAACO,MAAL,CAAYE,GAAZ,CAAH,EAAoB;YAChBD,gBAAgB,CAACE,IAAjB,CAAsBV,IAAI,CAACO,MAAL,CAAYE,GAAZ,CAAtB;UACH;QACJ;;QACD,MAAMD,gBAAgB,CAACG,IAAjB,EAAN;MACH;;MAEDjB,KAAK,CAACW,KAAN,CAAYL,IAAI,CAACY,KAAjB;MACA;;IACJ,KAAK,GAAL;MACIlB,KAAK,CAACW,KAAN,CAAYL,IAAI,CAACY,KAAjB;MACA;;IACJ,KAAK,GAAL;MACIjB,OAAO,CAACe,IAAR,CAAa;QACTG,QAAQ,EAAC,eADA;QAETC,KAAK,EAAE;UAACT,KAAK,EAACA;QAAP;MAFE,CAAb;MAIA;;IACJ;MACI;EAxBR;;EA0BA,OAAOU,OAAO,CAACC,MAAR,CAAeX,KAAK,CAACN,QAArB,CAAP;AACH,CAhCD;AAkCA,MAAMkB,QAAQ,GAAG;EACbC,GAAG,EAAGC,GAAD,IAAgB1B,KAAK,CAACyB,GAAN,CAAUC,GAAV,EAAeC,IAAf,CAAoBtB,YAApB,CADR;EAEbuB,IAAI,EAAE,CAACF,GAAD,EAAaG,IAAb,KAAyB7B,KAAK,CAAC4B,IAAN,CAAWF,GAAX,EAAgBG,IAAhB,EAAsBF,IAAtB,CAA2BtB,YAA3B,CAFlB;EAGbyB,GAAG,EAAE,CAACJ,GAAD,EAAaG,IAAb,KAAyB7B,KAAK,CAAC8B,GAAN,CAAUJ,GAAV,EAAeG,IAAf,EAAqBF,IAArB,CAA0BtB,YAA1B,CAHjB;EAId0B,MAAM,EAAGL,GAAD,IAAgB1B,KAAK,CAAC+B,MAAN,CAAaL,GAAb,EAAkBC,IAAlB,CAAuBtB,YAAvB;AAJV,CAAjB;AAOA,MAAM2B,OAAO,GAAG;EACZC,IAAI,EAAE,MAAMT,QAAQ,CAACC,GAAT,CAAa,UAAb,CADA;EAEZS,OAAO,EAAGC,EAAD,IAAgBX,QAAQ,CAACC,GAAT,CAAc,YAAWU,EAAG,EAA5B;AAFb,CAAhB;AAKA,MAAMC,UAAU,GAAG;EACfC,WAAW,EAAC,MAAMb,QAAQ,CAACC,GAAT,CAAa,mBAAb,CADH;EAEfa,WAAW,EAAC,MAAMd,QAAQ,CAACC,GAAT,CAAa,oBAAb,CAFH;EAGfc,WAAW,EAAC,MAAMf,QAAQ,CAACC,GAAT,CAAa,iBAAb,CAHH;EAIfe,WAAW,EAAC,MAAMhB,QAAQ,CAACC,GAAT,CAAa,oBAAb,CAJH;EAKfgB,kBAAkB,EAAC,MAAMjB,QAAQ,CAACC,GAAT,CAAa,wBAAb;AALV,CAAnB;AAQA,MAAMiB,KAAK,GAAG;EACVV,OADU;EAEVI;AAFU,CAAd;AAKA,eAAeM,KAAf"},"metadata":{},"sourceType":"module"}